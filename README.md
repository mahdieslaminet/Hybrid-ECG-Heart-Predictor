# Hybrid-ECG-Heart-Predictor  
## ฺุงุฑฺูุจ ุงุฏฺฏุฑ ุนูู ุชุฑฺฉุจ ุจุฑุง ูพุดโุจู ุจูุงุฑโูุง ููุจ ุจุง ุงุณุชูุงุฏู ุงุฒ ุชุตุงูุฑ ุณฺฏูุงู ECG  

---

## ๐ ูุนุฑู ูพุฑูฺู  
ุงู ูพุฑูฺู ูพุงุฏูโุณุงุฒ ุนูู ููุงูู  
**ยซHybrid Deep Learning Framework for Heart Disease Prediction Using ECG Signal Imagesยป**  
ูโุจุงุดุฏ.  

ุฏุฑ ุงู ูุฏูุ ุชุฑฺฉุจ ุงุฒ ุดุจฺฉูโูุง **ฺฉุงููููุดู (CNN)** ุจุฑุง ุงุณุชุฎุฑุงุฌ ุฎูุฏฺฉุงุฑ ูฺฺฏโูุง ู **ุดุจฺฉูโูุง ุนุตุจ ูุตููุน (ANN)** ุจุฑุง ุทุจููโุจูุฏ ุฏูู ุจูุงุฑโูุง ููุจ ุงุณุชูุงุฏู ุดุฏู ุงุณุช.  
ูุฏู ููุงุ ุชุดุฎุต ุฎูุฏฺฉุงุฑ ู ุฏูู ูุถุนุชโูุง ูุฎุชูู ููุจ ุงุฒ ุฑู ุชุตุงูุฑ ุณฺฏูุงู ECG ุงุณุช.  

---

## โ๏ธ ูฺฺฏโูุง ฺฉูุฏ  
โ ูุนูุงุฑ **ุชุฑฺฉุจ CNNโANN (DLA-ANN)**  
โ ุงุณุชูุงุฏู ุงุฒ **VGG16** ุจูโุนููุงู ุงุณุชุฎุฑุงุฌโฺฉููุฏู ูฺฺฏ ุงุฒ ูพุด ุขููุฒุดโุฏุงุฏูโุดุฏู  
โ ูพุดุชุจุงู ุงุฒ ท ฺฉูุงุณ ูุฎุชูู ุจูุงุฑ ููุจ  
โ ุขููุฒุด ู ุชุณุช ุจุง **KaggleHub Dataset**  
โ ูุงุจูุช ุฐุฎุฑู ูุฏู ุขููุฒุดโุฏุฏู ุจุฑุง **ุงุณุชูุงุฏู ุฏุฑ ุงุณุชูุฑุงุฑ ูุงูุน (.h5)**  

---

## ๐ง ุณุงุฎุชุงุฑ ูุฏู  
- **ุจฺฉโุจูู CNN:** ุดุจฺฉู VGG16 ุจุง ูุฒูโูุง ImageNet  
- **ุชุฌูุน ูฺฺฏโูุง:** Global Average Pooling  
- **ูุงูโูุง Dense:** ุดุงูู ตฑฒ ู ฒตถ ููุฑูู ุจุง ูุนุงูโุณุงุฒูุง LeakyReLU ู Swish  
- **ุฎุฑูุฌ:** Softmax ุจุฑุง ท ฺฉูุงุณ ุจูุงุฑ ููุจ  
- **ุจูููโุณุงุฒ:** Adam (ูุฑุฎ ุงุฏฺฏุฑ 0.0001)  
- **ูุนุงุฑูุง ุงุฑุฒุงุจ:** Accuracyุ Recall (Sensitivity) ู Precision  

---

## ๐ ุฏุงุฏูโูุง  
ุฏุงุฏูโูุง ุงุฒ ุทุฑู ฺฉุชุงุจุฎุงููโ **KaggleHub** ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุฏุงูููุฏ ูโุดููุฏ:  
```
mohamedeldakrory8/ecg-heart-categorization-dataset-image-version
```  

- ุดุงูู ูพูุดูโูุง **train** ู **test**  
- ุชูุงู ุชุตุงูุฑ ุจู ุงุจุนุงุฏ **224ร224** ุชุบุฑ ุงูุฏุงุฒู ุฏุงุฏู ูโุดููุฏ.  

---

## ๐ ูุญูู ุงุฌุฑุง  

### ๐จ ูุตุจ ูพุดโูุงุฒูุง  
```bash
pip install tensorflow kagglehub numpy matplotlib
```

### โ ุงุฌุฑุง ูพุฑูฺู ุฏุฑ Google Colab  
ฺฉุฏ ุจูโุตูุฑุช ฺฏุงูโุจูโฺฏุงู ุฏุฑ ุณูููโูุง ููุดุชู ุดุฏู ุงุณุช. ฺฉุงูโุณุช ุณูููโูุง ุฑุง ุจู ุชุฑุชุจ ุงุฌุฑุง ฺฉูุฏ ุชุง ุฏุงูููุฏ ุฏุงุฏูุ ุขููุฒุด ูุฏู ู ุงุฑุฒุงุจ ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุงูุฌุงู ุดูุฏ.

### ๐จ ุขููุฒุด ูุฏู  
```python
history = model.fit(train_data, validation_data=val_data, epochs=10)
```

##๐ฅ ุฐุฎุฑู ู ุจุงุฑฺฏุฐุงุฑ ูุฏู  
```python
model.save('ecg_dla_ann_model.h5')
loaded_model = load_model('ecg_dla_ann_model.h5')
```

### ๐ผ ูพุดโุจู ฺฉ ุชุตูุฑ ECG  
```python
img = image.load_img(img_path, target_size=(224, 224))
img_array = image.img_to_array(img) / 255.0
img_batch = np.expand_dims(img_array, axis=0)
pred = loaded_model.predict(img_batch)
predicted_index = np.argmax(pred)
class_labels = list(train_data.class_indices.keys())
predicted_label = class_labels[predicted_index]
confidence = pred[0][predicted_index] * 100
```

---

## โ๏ธ ูฺฉุงุช ููู ู ุฑูุน ุงุดฺฉุงู (Troubleshooting)  
- ูุฑุงูุจ ูุชุบุฑูุง ุชุนุฑูโูุดุฏู ุจุงุดุฏ: ุจูโุฌุง `img_tensor` ุงุฒ `img_batch` ุงุณุชูุงุฏู ฺฉูุฏ.  
- ุงฺฏุฑ ููุฏุงุฑ ูุงูุน (`true_label_index`) ุฑุง ูุฏุงุฑุฏุ ุฎุทูุท ูุฑุจูุทู ุฑุง ุญุฐู ฺฉูุฏ ุชุง ุงุฒ ุฎุทุง `NameError` ุฌููฺฏุฑ ุดูุฏ.  
- ูุฏู ุฑุง ููุท ฺฉโุจุงุฑ ุจุงุฑฺฏุฐุงุฑ ฺฉูุฏ (`load_model`) ู ุงุฒ ููุงู ููููู ุจุฑุง inference ุงุณุชูุงุฏู ฺฉูุฏ.  
- ุงุฒ ฺฉ ูพุดโุจู ูุงุญุฏ (`predict`) ุจุฑุง ูููู ููุงุดโูุง ู ูฺฏุงุดุชโูุง ุจุฑฺุณุจ ุงุณุชูุงุฏู ฺฉูุฏ ุชุง ูุชุงุฌ ููฺฏูู ุจูุงููุฏ.  

---

## ๐ ููููู ูุชุงุฌ  

| ูุนุงุฑ | ููุฏุงุฑ ูุฏู ุฏุฑ ููุงูู | ููุฏุงุฑ ูุฏู ุดูุง |
|:------|:------------------:|:---------------:|
| ุฏูุช (Accuracy) | 93.6% | ~YourResult% |
| ุญุณุงุณุช (Sensitivity) | 97.4% | ~YourResult% |
| ุฏูุช (Precision) | 97.9% | ~YourResult% |

---

## ๐งฉ ููููู ุฎุฑูุฌ ูพุดโุจู  

```
--- ฺฏุฒุงุฑุด ุชุญูู ููุจ ---
ูุชุฌู ุชุดุฎุต: ุณฺฉุชู ููุจ (Myocardial Infarction)
ุชูุถุญ ุจุฑุง ฺฉุงุฑุจุฑ: ุนูุงุฆู ุณฺฉุชู ููุจ ุชุดุฎุต ุฏุงุฏู ุดุฏ. ููุฑุงู ุจู ูพุฒุดฺฉ ูุฑุงุฌุนู ฺฉูุฏ.
ูุฒุงู ุงุทููุงู ุณุณุชู: 96.4%
```

---

## ๐๏ธ ูพุดููุงุฏูุง ุจูุจูุฏ ุขูุฏู  
- ุงูุฒูุฏู ูุงูโูุง **LSTM** ุง ูุงฺููโูุง ุชุฑุชุจ ุจุฑุง ุฏุฑฺฉ ุจูุชุฑ ูฺฺฏโูุง ุฒูุงู ุณฺฏูุงู ECG  
- ูพุงุฏูโุณุงุฒ **Grad-CAM** ุฌูุช ููุงุด ููุงุญ ุชุตูุฑ ฺฉู ุจุดุชุฑู ุชุงุซุฑ ุฑุง ุฏุฑ ุชุตููโฺฏุฑ ูุฏู ุฏุงุดุชูโุงูุฏ  
- ุงุณุชูุงุฏู ุงุฒ **fine-tuning** ุฑู ุจฺฉโุจูู VGG16 ุจุฑุง ุงูุฒุงุด ุฏูุช ุฏุฑ ุตูุฑุช ูุฌูุฏ ุฏุงุฏูู ฺฉุงู  
- ุณุงุฎุช ฺฉ **ุฑุงุจุท ูุจ** ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ุชุตูุฑ ู ููุงุด ูุชุฌู ุจู ฺฉุงุฑุจุฑ (Flask/FastAPI + React)  

---
